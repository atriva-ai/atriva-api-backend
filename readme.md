## **📝 README.md (Retail Backend API Service)**

# 🧠 Retail Backend API

This is the backend service for the Retail Camera Analytics Dashboard, built with **FastAPI** and backed by **PostgreSQL**. It provides RESTful APIs (and optional Socket.IO) to support:

- Camera configuration
- Visitor traffic analytics
- Staff activity tracking
- Integration with AI analytics engines
- Data services consumed by the v0.dev-based frontend

---

## 🚀 Features

- FastAPI + Pydantic for clean and performant API development
- PostgreSQL via SQLAlchemy ORM
- RESTful API endpoints for:
  - Cameras
  - Zones
  - Analytics configurations
- Modular folder structure for models, schemas, CRUD logic, and routes
- Designed to scale alongside analytics engine containers
- Docker support with `docker-compose`

---

## 📁 Project Structure
```markdown
retail-backend/
│
├── app/
│   ├── main.py               # FastAPI entry point
│   ├── db/
│   │   ├── models/           # SQLAlchemy DB models
│   │   ├── schemas/          # Pydantic schemas for validation
│   │   ├── crud/             # Business logic for DB ops
│   │   └── database.py       # DB session + engine setup
│   └── routes/
│       ├── camera.py
│       ├── zone.py
│       └── analytics.py
│
├── Dockerfile
├── requirements.txt
└── README.md
```

---

## 🚀 Running Locally with Docker Compose

### Prerequisites

- Docker & Docker Compose
- Optional: Python 3.10+ with `virtualenv` for manual runs

### Setup with Docker

Make sure you have the following directory structure at the root of your infra setup:

```
project-root/
├── retail-backend/
├── retail-dashboard/
└── infra/
    └── docker-compose.yml
└── service/
    └── analytics-engine/
```

```bash
# From the infra/ directory:
docker-compose up --build
```

This will bring up:
- PostgreSQL database
- Retail API backend (FastAPI)
- Any defined analytics engines
- Frontend UI

The API will be available at:  
📍 `http://localhost:8000`

Docs auto-generated by FastAPI:  
🧾 `http://localhost:8000/docs`


🛠 Development
Run FastAPI without Docker
```
uvicorn app.main:app --reload
```

Make sure your local PostgreSQL DB is running and matches the config in app/db/database.py.

---

## ⚙️ Environment Variables

Example `.env` file:

```env
DATABASE_URL=postgresql://postgres:postgres@db:5432/postgres
API_KEY=your-secret-key
```

---

## 📬 API Endpoints (Examples)

| Method | Endpoint                  | Description                        |
|--------|---------------------------|------------------------------------|
| GET    | `/api/cameras`            | List all configured cameras        |
| POST   | `/api/cameras`            | Register a new camera              |
| PUT    | `/api/analytics/engines`  | Update analytics engine settings   |
| GET    | `/api/traffic`            | Get visitor traffic analytics      |
| GET    | `/api/staff/activity`     | Staff service metrics              |

Explore full docs at `/docs`.

---

## 🧱 Database

This project uses **PostgreSQL**. It connects via `DATABASE_URL`. You can optionally use **Alembic** for migrations:

```bash
alembic revision --autogenerate -m "init"
alembic upgrade head
```

---

## 🧩 Frontend Integration

This backend is intended to be consumed by the dashboard frontend.

Ensure API URLs are correctly proxied or accessed via:

```ts
http://localhost:8000/api/*
```

Or within Docker:

```ts
http://core-api:8000/api/*
```

---

📌 Notes
- Database tables are created automatically in development using Base.metadata.create_all.
- For production, use proper database migrations (e.g., Alembic).
- Use versioned APIs (/api/v1) to support future changes.

---

## 🛠 Tech Stack

- FastAPI
- PostgreSQL
- Docker
- Pydantic
- Uvicorn

---

## 📄 License

MIT License © 2025

---

